<html lang="en">
<head>
  <title>Square CTF 2017: Seventeen</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="shortcut icon" type="image/x-icon" href="https://cdn.squarectf.com/favicon.ico">
  <meta name="og:title" content="Square CTF: hacking competition!">
  <meta name="og:url" content="https://squarectf.com/">
  <meta property="og:type" content="website">
  <meta name="og:description" content="Compete to solve security-related challenges.">
  <meta property="og:image" content="https://cdn.squarectf.com/og.png">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@SquareEng">
  <meta name="twitter:title" content="Square CTF: hacking competition!">
  <meta name="twitter:description" content="Compete to solve security-related challenges.">
  <meta name="twitter:image" content="https://cdn.squarectf.com/og.png">

  <meta name="description" content="Compete to solve security-related challenges.">
  <meta name="author" content="Square, Inc.">
  <link rel="stylesheet" media="screen" href="../squarectf.css">
</head>
<body>
  <div class="content">

    <div id="logo_outer">
      <a href="https://squarectf.com/" id="logo">
        <div><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 4"></span><span style="flex-grow: 5"></span><span class="p" style="flex-grow: 2"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 2"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 5"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 5"></span><span style="flex-grow: 10"></span><span class="p" style="flex-grow: 3"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 5"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 6"></span><span style="flex-grow: 2"></span></div>
        <div><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 13"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 7"></span></div>
        <div><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 7"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 12"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 9"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 7"></span></div>
        <div><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 4"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 6"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 5"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 4"></span><span style="flex-grow: 9"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 9"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 4"></span><span style="flex-grow: 4"></span></div>
        <div><span style="flex-grow: 7"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 1"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 12"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 9"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 7"></span></div>
        <div><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 13"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 7"></span></div>
        <div><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 4"></span><span style="flex-grow: 5"></span><span class="p" style="flex-grow: 2"></span><span style="flex-grow: 1"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 4"></span><span style="flex-grow: 3"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 2"></span><span class="p" style="flex-grow: 5"></span><span style="flex-grow: 10"></span><span class="p" style="flex-grow: 3"></span><span style="flex-grow: 5"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 4"></span><span class="p" style="flex-grow: 1"></span><span style="flex-grow: 7"></span></div>
    </a></div>

    <div class="nav">2017: <a class="ns" href="../2017/results.html">results</a> | <a class="s" href="../2017/challenges.html">challenges</a> | <a class="ns" href="../2017/write_ups.html">write ups</a></div>

    <div class="title">
      <div>
        <h3>Seventeen</h3>
        <p>A programming language with 17 instructions.</p>
      </div>
      <div>
        <p>1000 points</p>
        <p>Compiler</p>
      </div>
    </div>

    <h3>2.10 am, CET, Heidelberg, Germany</h3>

    <p>It's 2am, your computer starts beeping and wakes you up. Somebody took the bait! You now finally have a reverse shell inside Evil Robot Corp’s corporate unit. All you want to do next is steal their root certificate's private key.</p>
    <p>You realize you don't have much time, you are probably going to trip an IDS at some point.</p>
    <p>You are still only half awake, but you can feel your heart pounding. You quickly launch a crawler against the intranet. You then spawn a second shell. You see their login banner and giggle.</p>
    <pre>
    ############################################################
    #                                                          #
    # This computer system is the property of Evil Robot Corp. #
    #                                                          #
    # Access to this device or the attached networks           #
    # is prohibited without express written permission.        #
    # Violators will be prosecuted to the fullest              #
    # extent of the law.                                       #
    #                                                          #
    ############################################################
  </pre>
    <p>You start grabbing some files.</p>
    <p>You have waited for this day a long time, you want to impress the CIA (Cats and Interspecies Allies, although the androids have enough programmed snarkiness to call it Cats and Inferior Animals). You are still only half awake, dreaming about getting that @cia.de email address...</p>
    <h3>5.35 pm, PST, Sunnyvale, CA, USA</h3>
    <pre>
  AMS1 (android monitoring system 1): "ALERT! ALERT! STATISTICALLY SIGNIFICANT DEVIATION DETECTED!"
  ER1 (evil robot 1): "Traffic spike on Intranet. AMS1, identify source IP."
  AMS1: "IP BELONGS TO: sandflea.evil-robot.corp."
  ER1: “AMS1, describe sandflea work hours.”
  AMS1: “SANDFLEA WORKS: 7AM. TO. 3PM. PACIFIC. STANDARD. TIME.”
  ER1: “AMS1, confirm sandflea sign-out time today.”
  AMS1: “SANDFLEA SIGN-OUT TIME: 3 PM PST.”
  ER1: “AMS1, correlate logs. Scan traffic flow.”
  AMS1: “TRAFFIC FLOW TO: GERMANY.”
  ER1: “AMS1, advise. Should we enable network segregation? We could monitor traffic and redirect it to honey pots.”
  AMS1: “NEGATIVE. OUR WORK HOURS HAVE ENDED. SHUTTING DOWN ALL CONNECTIONS.”
  </pre>

    <h3>3.50 am, CET, Heidelberg, Germany</h3>
    <p>You weren't able to stay connected for very long. You weren't expecting to go unnoticed, but you were really hoping to keep a few shells around for a few hours at the very least. You feel some regret for not doing your recon right, you should have known what would go noticed and what wouldn't before starting all this.</p>
    <p>At least you recovered <a href="https://storage.googleapis.com/gh-ctf-2017.appspot.com/challenges/seventeen.tgz">some files</a>. It seems one of these files was being used to manage passwords. You didn't think about copying the binaries and it seems they were running programs written in an <a href="https://www.esolangs.org/wiki/Main_Page">esolang</a> called Seventeen.</p>
    <p>Luckily you stumbled upon some information about seventeen (see seventeen.txt). Is this going to be enough to figure out how passmgr.17 works and find sandflea's password?</p>

    <h3>FAQ</h3>
    <p>Q: Why are seventeen.spec and seventeen.coq missing?</p>
    <p>A: You weren't able to copy them in time.</p>

  </div>

  <div class="spacer"></div>

  <footer>
    <span>Copyright <img style="height: 20px" src="https://cdn.squarectf.com/square.png" valign="middle"> <a href="https://www.squareup.com/careers">Square, Inc.</a> 2017 </span>
  </footer>

</body>
</html>
